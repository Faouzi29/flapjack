package commonline.core.parser;

import commonline.core.layout.FieldDefinition;
import commonline.core.layout.RecordLayout;

import java.util.ArrayList;
import java.util.Iterator;
import java.util.List;

/**
 * Breaks up the array of bytes into fields and converts them to Strings
 */
public class StringRecordFieldParser implements RecordFieldParser {
    public Object parse(byte[] bytes, RecordLayout recordLayout) throws ParseException {
        List fields = new ArrayList();

        if (bytes.length > 0) {
            String line = new String(bytes);
            StringFieldParser fieldParser = new StringFieldParser();

            Iterator it = recordLayout.getFieldDefinitions().iterator();
            while (it.hasNext()) {
                FieldDefinition fieldDefinition = (FieldDefinition) it.next();
                fields.add(fieldParser.parse(line, fieldDefinition));
            }
        }

        return fields;
    }


}
